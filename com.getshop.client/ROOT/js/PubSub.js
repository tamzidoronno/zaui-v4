var PubSub={};(function(p){"use strict";p.version="1.0.2";var messages={},lastUid=-1;function publish(message,data,sync){if(!messages.hasOwnProperty(message)){return false;}function deliverMessage(){var subscribers=messages[message],i,j;for(i=0,j=subscribers.length;i<j;i++){subscribers[i].func.apply(subscribers[i].scope,[message,data]);}}if(sync===true){deliverMessage();}else{setTimeout(deliverMessage,0);}return true;}p.publish=function(message,data){return publish(message,data,false);};p.publishSync=function(message,data){return publish(message,data,true);};p.subscribe=function(message,func,scope){if(!messages.hasOwnProperty(message)){messages[message]=[];}var token=(++lastUid).toString();messages[message].push({token:token,func:func,scope:scope});return token;};p.unsubscribe=function(token){var m,i,j;for(m in messages){if(messages.hasOwnProperty(m)){for(i=0,j=messages[m].length;i<j;i++){if(messages[m][i].token===token){messages[m].splice(i,1);return token;}}}}return false;};}(PubSub));