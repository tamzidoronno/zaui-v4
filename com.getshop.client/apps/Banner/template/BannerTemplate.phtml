<div class="bannerview">
    <?php
$id = uniqid();
    $interval = $this->getInterval();
    $height = $this->getHeight() ? "height:".$this->getHeight()."px" : "";
    
    if (count($this->getBanners()) == 0 && $this->isEditorMode()) {
        ?>
        <div class='nobannersadded'>
            <div class='banner_info_text'>
                <? echo $this->__f('Almost done! all you need to do now is to upload your images. Hover the mouse over this image and the gear will appear.'); ?>    
            </div>
        </div>
        <script>
            $('.nobannersadded').each(function()Â {
                $(this).height($(this).width() / 3);
            });
        </script>
        <?
    }
    ?>
    <div class="uploadprogress_bannerslider">
        <? echo $this->__f("Upload in progress, please wait."); ?>
        <div class="bannerslider_uploads">
            
        </div>
    </div>
    <div style='<? echo $height; ?>' class="bannerslider" id="<? echo $id; ?>" interval="<? echo $interval; ?>">
        <?
        foreach ($this->getBanners() as $banner) {
            $imageId = $banner->imageId;
            echo "<div class='banner' imageId='$imageId'>";
           
            if (isset($banner->productId) && strlen(trim($banner->productId)) > 0) {
                echo "<a href='" . $this->getProductLink($banner->productId) . "'>";
            }
            
            if (isset($banner->link) && strlen(trim($banner->link)) > 0) {
                echo "<a href='" . $banner->link . "'>";
            }
            $crop = json_decode($banner->crop_cordinates);
            
            $cropData = "";
            if ($crop) {
                $cropData = "&crop=true&x=" . $crop->x . "&x2=" . $crop->x2 . "&y=" . $crop->y . "&y2=" . $crop->y2 . "&rotation=".$banner->rotation;
            }
            echo "<img height='".$height."' width='100%' src='displayImage.php?id=$imageId" . $cropData . "'/>";
            if (isset($banner->productId) && strlen(trim($banner->productId)) > 0) {
                echo "</a>";
            }
            if (isset($banner->link) && strlen(trim($banner->link)) > 0) {
                echo "</a>";
            }
            echo "</div>";
        }
        $i = 0;
        if ($this->isShowDots()) {
            ?>
            <div class="dots">
                <?
                foreach ($this->getBanners() as $banner) {
                    $imageId = $banner->imageId;
                    ?>
                    <div onclick="app.Banner.goToImage('<? echo $id; ?>', <? echo $i; ?>)" imageid="<? echo $imageId; ?>" class="dot inline"></div>
                    <?
                    $i++;
                }
                ?>
            </div>
<? } ?>
    </div>


    <script>
        app.Banner.Slider.start('<?php echo $id; ?>');
    </script>
</div>