<?php
$guestInfoBox = <<<EOD
<div class="guestInfoBox">
    <div class='guestInfoBox_left'>
        <div>Rooms</div>
        <div>Adults </div>
        <div style='top:-6px;'>Children <br><span style="font-size:12px;position:absolute;left:0;">Ages 2-12</span></div>
    </div>
    <div class='guestInfoBox_right'>
        <div class="count_line">
            <i id="subtract_room" class="fa fa-minus disabled"></i><input type="txt" class="count" id="count_room" value="1" readonly><i id="add_room" class="fa fa-plus"></i>
        </div>
        <div class="count_line">
            <i id="subtract_adult" class="fa fa-minus disabled"></i><input type="txt" class="count" id="count_adult" value="1" readonly><i id="add_adult" class="fa fa-plus"></i>
        </div>
        <div class="count_line">
            <i id="subtract_child" class="fa fa-minus disabled "></i><input type="txt" class="count" id="count_child" value="0" readonly><i id="add_child" class="fa fa-plus"></i>
        </div>
    </div>
    <div class="guestInfoBox_footer">
        <div onclick="confirmGuestInfoBox()">Apply</div>
    </div>
</div>
EOD;

$destinationInfoBox = <<<EOD
<div class="destinationInfoBox">
    <div class='destination_line'><img class="destination_image" src="https://www.visitoslo.com/Images/Bilder%20Oslo/Attraksjoner/Akrobaten%20mot%20Barcode_Leif%20Harald%20Ruud.jpg?t=ScaleToFill%7C1450x720&ts=ajCYo6pTmf0Mfh7RGfLmeiDlLmE%3D">Getshop Hotel, Oslo</div>
    <div class='destination_line'><img class="destination_image" src="https://media.newmindmedia.com/TellUs/image/?file=3F59853038189DAC967CB6AB12EE7B4F977148CA.jpg&dh=392&dw=526">Getshop Hotel, Tønsberg</div>
</div>
EOD;
?>
<div class='gslfront_1'>
    <div class='gslbookingHeader'>
        <div class="fa_box destination">
            <input id="destination" placeholder="Destination?" onfocus="this.placeholder =''" onblur="this.placeholder ='Destination?'" style="border-right:1px solid #ddd;" readonly>
                <? echo $destinationInfoBox; ?>
        </div><div class="fa_box date">
            <input id="date_picker" style="border-right:1px solid #ddd;" readonly>
        </div><div class="fa_box guests">
            <input id="guests" value="1 room, 1 guest" style="border-right:1px solid #ddd;" readonly>
                <? echo $guestInfoBox;?>
        </div><div class="fa_box coupon">
            <input id='coupon_input' onfocus="this.placeholder =''" onblur="this.placeholder ='Discount coupon?'" placeholder="Discount coupon?">
        </div><div class="fa_box gsl_button" id="search_rooms" onclick="showProductList()">Search</div>
    </div>
    <div class="show_body_footer">
    <div class="gslbookingBody">
        <div class="productoverview">
            <div class="productentry">
                <div style="width:30%;float:left;">
                    <img class='roomimg' src='https://www.regalhotel.com/uploads/rrh/accommodations/720x475/DeluxeSuite_FINAL_large.jpg'> 
                </div>
                <div class="productentry_main">
                    <div class="productentry_header">
                        <div>Double room</div>
                        <div style="float:right;">from NOK 799,-</div>
                        <div style="font-size:12px;">Available rooms: 23</div>
                    </div>
                    <div class="productentry_itemlist">
                        <i class="fa fa-user" style="padding-left:10px;"></i>
                        <i class="fa fa-user"></i>
                        <div>Double room, 2 guests NOK 999,-</div>
                        <div style="float:right;padding:0;">
                            <span>Number of rooms</span>
                            <select class="numberof_rooms"><option value="0">0</option><option value="1">1 &nbsp;(NOK 999,-)</option><option  value="2">2 &nbsp;(NOK 1899,-)</option></select>
                        </div>
                    </div>
                    <div class="productentry_itemlist">
                        <i class="fa fa-user" style="padding-left:10px;"></i>
                        <div>Double room, 1 guest NOK 799,-</div>
                        <div style="float:right;padding:0;">
                            <span>Number of rooms</span>
                            <select class="numberof_rooms"><option value="0">0</option><option value="1">1 &nbsp;(NOK 799,-)</option><option value="2">2 &nbsp;(NOK 1499,-)</option></select>
                        </div>
                    </div>
                    <div class="productentry_body">
                        <div>Praesent ex mauris, vehicula non dui sit amet, tempus tristique arcu. Suspendisse sem felis, efficitur accumsan ipsum in, accumsan ultricies ante. Donec at odio felis. Curabitur feugiat venenatis fermentum. Etiam eget malesuada velit. Quisque sollicitudin luctus scelerisque. Sed dui enim, consequat at sem sit amet, malesuada auctor magna.</div>
                    </div>
                    <div class="productentry_footer">
                        <i class="fa fa-wifi"></i>
                        <i class="fa fa-shield"></i>
                        <i class="fa fa-desktop"></i>
                    </div>
                </div>
                <div style="clear:both;"></div>
            </div>
            <div class="productentry">
                <div style="display: inline-block;width:30%;float:left;">
                    <img class='roomimg' src='http://static.wynnlasvegas.com/~/media/WLV/Rooms%20and%20Suites/Encore%20Tower%20Suites/Salon%20Suite/2_129_encore_salon_suite_bedroom.jpg?h=540&la=en&w=1001&vs=1&d=20170331T095925'> 
                </div>
                <div class="productentry_main">
                    <div class="productentry_header">
                        <div>Suite</div>
                        <div style="font-size:12px;">Available rooms: 7</div>
                        <div style="float:right;">from NOK 1299,-</div>
                    </div>
                    <div class="productentry_itemlist">
                        <i class="fa fa-user" style="padding-left:10px;"></i>
                        <i class="fa fa-user"></i>
                        <i class="fa fa-user"></i>
                        <i class="fa fa-user"></i>
                        <div>Suite, 4 guests NOK 1299,-</div>
                        <div style="float:right;padding:0;">
                            <span>Number of rooms</span>
                            <select class="numberof_rooms"><option value="0">0</option><option value="1">1 &nbsp;(NOK 1299,-)</option></select>
                        </div>
                    </div>
                    <div class="productentry_body">
                        <div>In et ultrices felis, quis ullamcorper ex. Cras vestibulum sit amet tellus auctor semper. Etiam sed nulla nulla. Vestibulum eget purus vel nibh porttitor dapibus sed at tortor. Nulla a nulla ut nulla porta vulputate sit amet vitae risus. Nunc eleifend ac nisl nec feugiat. Phasellus vulputate ante ac convallis aliquam. Mauris a nisl nec nibh euismod rutrum non id lorem.</div>
                    </div>
                    <div class="productentry_footer">
                        <i class="fa fa-wifi"></i>
                    </div>
                </div>
                <div style="clear:both;"></div>
            </div>
            <div>
                <div class="productentry_total">Total 2 rooms with a cost of: 1299,-</div><div id="productentry_confirm" class="gsl_button">Continue <i class="fa fa-arrow-right"></i></div>
            </div>
        </div>
        <div class="addons_guests">
            <div style="width:30%;float:right;background-color:#efefef;">
                <div style="padding:10px;">
                    <h4 style="border-bottom: 1px solid #ddd;padding-bottom: 4px;">Your stay at GetShop Hotel</h4>
                    <div>
                        2 nights, Oct 20 - Oct 22<br>
                        Room 1, 2 guests - Suite<br><br>
                        1 x double room<br>
                        1 x single room<br>
                        3 x Breakfast<br>
                    </div>
                    <h4>Total</h4><p>NOK 1599,-</p>
                    <div style="position:absolute;bottom:10px;right:0; width:30%;"><div class="addons_guests_return gsl_button" onclick="showProductList()"><i class="fa fa-arrow-left"></i> Return</div><div class="addons_guests_confirm gsl_button" onclick="showOverviewPage()">Continue <i class="fa fa-arrow-right"></i></div></div>
                </div>
            </div>
            <div style="width:70%;background-color:#f9f9f9;padding:10px;box-shadow: inset -1px 0 0 #ddd;">
                <div class="addonsentry">
                    <h4>Addons</h4>
                    Add addons for all guests, or add individual addons under guest info.
                    <div class="overview_addons">
                        <div class="addon">
                            <div style="width:60%;">Early check in. Check in 12:00  in the morning</div><div>NOK 149,-</div><div class="addButton gsl_button">Add</div>
                        </div>
                        <div class="addon">
                            <div style="width:60%;">Breakfast for all guests in the mornings</div><div>NOK 99,-</div><div class="addButton gsl_button">Add</div>
                        </div>
                        <div class="addon">
                            <div style="width:60%;">Coat for one person. Keeps you warm in the morning</div><div>NOK 299,-</div><div class="addButton gsl_button">Add</div>
                        </div>
                        <div class="addon">
                            <div style="width:60%;">Late check out, from 11:00 in the morning, to 16:00 in the evening</div><div>NOK 249,-</div><div class="addButton gsl_button">Add</div>
                        </div>
                        
                    </div>
                </div>
                <h4>Guest info</h4>
                It's important to enter the correct e-mail and phone number for each guest. It will be used for door codes and useful information.
                <div class="roomentryframe">
                    <div class="roomentry">
                        <h4>Room 1 - Double Room</h4>
                        <div class="guestentry">
                            <div>Name<br><input type="txt">
                            </div><div>E-mail<br><input type="txt">
                            </div><div>Phone<br><input type="txt" class="guest_phone" value="+47"><input type="text" style="width:75%;">
                            </div><div>Addons<br>
                                <div style="border: 1px solid #ddd;padding: 8px;width:100%;position: relative;">
                                    <i class="fa fa-sign-in" title="Early check in"></i><i class="fa fa-cutlery" title="Breakfast"></i><i class="fa fa-black-tie" title="Coat for one person"></i><i class="fa fa-sign-out" title="Late check out"></i>
                                    <i class="fa fa-times removeguest" title="Remove guest"></i>
                                </div>
                            </div>
                        </div>
                        <div class="guestentry">
                            <div>Name<br><input type="txt">
                            </div><div>E-mail<br><input type="txt">
                            </div><div>Phone<br><input type="txt" class="guest_phone" value="+47"><input type="text" style="width:75%;">
                            </div><div>Addons<br>
                                <div style="border: 1px solid #ddd;padding: 8px;width:100%;position: relative;">
                                    <i class="fa fa-sign-in" title="Early check in"></i><i class="fa fa-cutlery" title="Breakfast"></i><i class="fa fa-black-tie" title="Coat for one person"></i><i class="fa fa-sign-out" title="Late check out"></i>
                                    <i class="fa fa-times removeguest" title="Remove guest"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="addguest gsl_button"><i class="fa fa-plus"></i> Add guest</div>
                </div>
            </div>
        </div>
        <div class="overview">
            <div class="overview_room_info">
                <h4 style="border-bottom: 1px solid #ddd;padding-bottom: 4px;">Your stay at GetShop Hotel</h4>
                <div>
                    2 nights, Oct 20 - Oct 22<br>
                    Room 1, 2 guests - Suite<br><br>
                    1 x double room<br>
                    1 x single room<br>
                    3 x Breakfast<br>
                </div>
                <h4>Total</h4><p>NOK 1599,-</p>
                <div class="overview_confirmation">
                    <div class="gsl_button addons_guests_return" onclick="showAddonsPage()"><i class="fa fa-arrow-left"></i> Return</div><div class="complete_booking_button gsl_button">Go to payment</div>
                </div>
            </div>
            <div class="overview_article">
                <div class="overview_contact">
                    <h4>Contact information</h4>
                    This is used for contacting regarding your stay. Be sure to pick private or organization.
                    <br><br>
                    <div class="overview_contact_tab">
                        <input type="radio" id="private" name="user" checked="checked">
                        <label for="private">Private</label>
                        <input type="radio" id="organization"name="user">
                        <label for="organization">Organization</label>
                        <input type="radio" id="gotAccount"name="user">
                        <label for="gotAccount">Already got an Account?</label>
                    </div>
                    <br>
                    <div class="private_fields">
                        <div class="guestentry">
                            <div>First Name<br><input type="txt">
                            </div><div>Last Name<br><input type="txt">
                            </div><div>E-mail<br><input type="txt">
                            </div><div>Phone<br><input type="txt" class="guest_phone" value="+47"><input type="text" style="width:75%;border-right: 1px solid #ddd;">
                            </div>
                        </div>
                        <div class="guestentry">
                            <div style="width: 50%;">Street Adress<br><input type="txt">
                            </div><div style="width: 50%;">Zip Code<br><input id="guest_zipcode" type="txt"  class="guest_phone" value=""><input id="guest_zipname" type="text" style="width:75%;border-right: 1px solid #ddd;">
                            </div>
                        </div>
                    </div>
                    <div style="clear: both;"></div>
                </div>
                <div style="padding:10px;">
                    <input id="agreeTerms" type="checkbox">
                    <label for="agreeTerms">I agree to terms</label>
                    <div><a style="cursor:pointer;">Read terms of use</a></div>
                    <div><a style="cursor:pointer;">Download terms of use</a></div>
                </div>
            </div>
        </div>
    </div>
    </div>
</div>

<link href="http://netdna.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css" rel="stylesheet">
<script type="text/javascript" src="http://netdna.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" media="all" href="/js/daterangepicker/daterangepicker.css" />
<script type="text/javascript" src="/js/daterangepicker/moment.js"></script>
<script type="text/javascript" src="/js/daterangepicker/daterangepicker.js"></script>

<script>
    $('#guest_zipcode').on('keyup', function(){
        var val = $(this).val();
        if(val.length !== 4) {
            return;
        }
        $.ajax({
            "dataType" : "jsonp",
            "url": "https://api.bring.com/shippingguide/api/postalCode.json?clientUrl=insertYourClientUrlHere&country=no&pnr=" + val,
            "success": function (data) {
                if(data.valid) {
                    $('#guest_zipname').val(data.result);
                }
            }
        }
        );
    });
    $('.numberof_rooms').on('change', function(){
        $('#productentry_confirm').addClass('active');
    });
    $('#productentry_confirm').on('click', function(){
        if($('#productentry_confirm').hasClass('active')){
            $('.productoverview').fadeOut('400', function(){
                $('.addons_guests').fadeIn('400');
            });
        }
    });
    $('.addguest').on('mousedown', function(){
        var addNewGuest = '<div class="guestentry"><div>Name<br><input type="text"></div><div>E-mail<br><input type="text"></div><div>Phone<br><input type="text"  class="guest_phone" value="+47"><input type="text" style="width:75%;"></div><div>Addons<br><div style="border: 1px solid #ddd;padding: 8px;width:100%;position: relative;"><i class="fa fa-sign-in" title="Early check in"></i><i class="fa fa-cutlery" title="Breakfast"></i><i class="fa fa-black-tie" title="Coat for one person"></i><i class="fa fa-sign-out" title="Late check out"></i><i class="fa fa-times removeguest" title="Remove guest"></i></div></div></div>';
        $('.roomentry').append(addNewGuest);
    });
    $(document).on('mousedown', function(e){
        var target =  $(e.target);
        if(target.is('.removeguest')){
            var removeGuest = confirm('Are you sure u want to remove this guest?');
            if(removeGuest === true){
                target.closest('.guestentry').remove();
            }
        }
    });
    $('.addButton').on('mousedown',function(){
        if($(this).hasClass('added_addon')){
            $(this).removeClass('added_addon').html('Add');
        }else{
            $(this).addClass('added_addon').html('Remove');
        }
    });
    $('.destination_line').on('mousedown', function(){
        var destination = $(this).text();
        if(destination !== ""){
            $('#destination').val(destination);
            $('.destinationInfoBox').hide();
        }
    });
    $('#date_picker').daterangepicker({
        "autoApply":true,
        "showWeekNumbers": true,
        "locale":{
            "direction":"ltr",
            "format": "DD MMM",
            "firstDay": 1
        }
    });
    $('#guests').on('focus',function(){
        $('.guestInfoBox').show();
    });
    $('#destination').on('focus',function(){
        $('.destinationInfoBox').show();
    });
    $('.guestInfoBox .fa').on('mousedown', function(){
        var minusButton = $(this).closest('.count_line').find('.fa-minus'); //Closest minusbutton
        var plusButton = $(this).closest('.count_line').find('.fa-plus'); //Closest plusbutton
        var count = $(this).closest('.count_line').find('.count'); //Closest numbercount for adding guests or room
        if($(this).is('.fa-plus')){
            if(count.val() < 10){
                count.val(function(i,val){
                    return (+val + 1);
                });
            }
            if($(this).is('#add_child') && count.val() >= 1){
                minusButton.removeClass('disabled');
            }else if(count.val() >= 2){
                minusButton.removeClass('disabled');
            }
            if(count.val() >= 10){
                plusButton.addClass('disabled');
            }
        }
        if($(this).is('.fa-minus')){
            if($(this).is('#subtract_child')){
                if(count.val() > 0){
                    count.val(function(i,val){
                        return (+val - 1);
                    });
                }
                if(count.val() <=0){
                    minusButton.addClass('disabled');
                }
            }else{
                if(count.val() > 1){
                    count.val(function(i,val){
                        return (+val - 1);
                    });
                }
                if(count.val() <=1){
                    minusButton.addClass('disabled');
                }
            }
            if(count.val() <= 9){
                plusButton.removeClass('disabled'); 
           }
        }
    });    
    $(document).on('mousedown', function(e){
        var target =  $(e.target);
        if(target.is('#guests') || target.hasClass('guestInfoBox') || target.closest('.guestInfoBox').length >= 1) {
            return;
        }
        confirmGuestInfoBox();
    });
    $(document).on('mousedown', function(e){
        var target =  $(e.target);
        if(target.is('#destination') || target.hasClass('destinationInfoBox') || target.closest('.destinationInfoBox').length >= 1) {
            return;
        }
        $('.destinationInfoBox').hide();
    });
    $('#coupon_input').on('change', function(){
        if($('#coupon_input').val() === "code" || $('#coupon_input').val() === "Code"){
            $(this).addClass('validCode');
            $(this).removeClass('non-validCode');
        }else if($('#coupon_input').val() === ""){
            $(this).removeClass('validCode');
            $(this).removeClass('non-validCode');
        }else{
            $(this).removeClass('validCode');
            $(this).addClass('non-validCode');
        }
    });
    $('#search_rooms').on('click', function(){
        var destination = $('#destination').val();
        var date = $('#datepicker').val();
        var rooms = $('#count_room').text();
        var adults = $('#count_adult').text();
        var children = $('#count_child').text();
        var discount = $('#coupon_input').val();
        var data = {
            "bookingid" : "filter",
            "name" : "Filter",
            "destination" : destination,
            "startDate" : date,
            "rooms" : rooms,
            "adults" : adults,
            "children" : children,
            "discount" : discount
        };
        return data;
    });
    function showAddonsPage(){
        $('.overview').hide();
        $('.productoverview').fadeOut('400', function(){
            $('.addons_guests').fadeIn('400');
        });
    };
    function showProductList(){
        $('.show_body_footer').fadeIn('400');
        $('.overview').hide();
        $('.addons_guests').fadeOut('400', function(){
            $('.productoverview').fadeIn('400');
        });
    };
    function showOverviewPage(){
        $('.addons_guests').fadeOut('400', function(){
            $('.overview').fadeIn('400');
        });
    };
    function previusPage(){
        $('.overview').fadeOut('400', function(){
            $('.productoverview').fadeIn('400');
        });
    };
    
    function confirmGuestInfoBox(){
        var room = $('#count_room').val(); 
        var adult = $('#count_adult').val();
        var child = $('#count_child').val();
        var guest = +adult + +child;
        var roomText = " room";
        var guestText = " guest ";
        if(room > 1){roomText = " rooms"}
        if(guest > 1){guestText = " guests "}
        $('#guests').val(room + roomText +', ' + guest + guestText);
        $('.guestInfoBox').hide();
    };
    var destinationType = [
        {
            "destinationid" : "getshophotel",
            "name" : "Getshop Hotel",
            "image" : "imageurl"
        }  
    ];
    var roomTypes = [
        {
            "roomid" : "singleroom",
            "name" : "Single room",
            "price" : [499],
            "maxGuests" : 1,
            "images" : ["1", "2", "3"],
            "description" : "Room for one guests",
            "availableRooms": 4
        },
        {
            "roomid" : "doubleroom",
            "name" : "Double room",
            "price" : [799,999],
            "maxGuests" : 2,
            "images" : [ "1", "2", "3"],
            "description" : "Room for two guests",
            "availableRooms": 23
        },
        {
            "roomid" : "tripleroom",
            "name" : "Triple room",
            "price" : [999,1199,1250],
            "maxGuests" : 3,
            "images" : [ "1", "2", "3"],
            "description" : "Room for up to three guests",
            "availableRooms": 10
        },
        {
            "roomid" : "suite",
            "name" : "Suite",
            "price" : [1299],
            "maxGuests" : 4,
            "images" : [ "1", "2", "3"],
            "description" : "Room for up to four guests",
            "availableRooms": 7
        }
    ];
</script>