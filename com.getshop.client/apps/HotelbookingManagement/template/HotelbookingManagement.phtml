<?php
namespace ns_15e67fa1_c862_4bc3_9b17_dfd818f30712;

$type = $this->getType();

$periode = "daily";
if(isset($_POST['data']['interval'])) {
    $periode = $_POST['data']['interval'];
}
$startDate = $this->getStartDate();
$endDate = $this->getEndDate();

$types = array();
$types['boder_aktiv'] = "Boder aktive";
$types['boder_alle'] = "Boder alle";
$types['boder_ledige'] = "Boder ledige";
$types['boder_ikke_startet'] = "Boder ikke startet";
$types['boder_sluttet'] = "Boder sluttet";
$types['stats'] = "Statistikk";
$types['coverage'] = "Belegg";


$periodes = array();
$periodes['daily'] = "Daglig";
$periodes['monthly'] = "MÃ¥nedlig";

if(isset($_POST['data']['updated'])) { 
    echo "<span class='updatedtext' style='float:right;'>Data har blitt oppdatert.</span>";
    ?>
    <script>
        setTimeout(function() {
            $('.updatedtext').hide();
        }, "2000");
    </script>
    <?
}
?>
<br>
<br>
<br>
<select id="selectweekdate">
    <option value="">Velg en uke</option>
    <? 
    $year = date("Y", time());
    for($i = 1; $i <= 52; $i++) {
        $date = strtotime($year . 'W' . str_pad(($i+1), 2, '0', STR_PAD_LEFT));
        $mondaytime = strtotime('last monday', $date);
        $monday = date("d.m.Y", $mondaytime);
        $sunday = date("d.m.Y", ($mondaytime+86400*7));
        echo "<option value='$monday;$sunday'>Week $i - $year</option>";
    }
    ?>
</select>

<div gstype="form"  method="displaySelection">
    <input type="startDate" class="startdate" gsname='startdate' value='<? echo $startDate; ?>'>
    <input type="endDate" class="enddate" gsname='enddate' value='<? echo $endDate; ?>'>
    <select gsname='interval' style='display:none;'>
        <? foreach($periodes as $index => $per) {
            $selected = "";
            if($index == $periode) {
                $selected = "SELECTED";
            }
            echo "<option value='$index' $selected>$per</option>";
        }
        ?>
    </select>
    <select gsname='type'>
        <? 
        foreach($types as $index => $typeprint) {
            $selected = "";
            if($index == $type) {
                $selected = "SELECTED";
            }
            echo "<option value='$index' $selected>$typeprint</option>";
        }
        ?>
    </select>
    <input type='button' value='Vis'  gstype="submit">
</div>

<script>
    $('.startdate').datepicker({ dateFormat: "dd.mm.yy",changeMonth: true,
      changeYear: true});
    $('.enddate').datepicker({ dateFormat: "dd.mm.yy",changeMonth: true,
      changeYear: true});
</script>

<?
switch($type) {
    case "stats":
        $this->includefile("bookingstats");
        break;
    case "coverage":
        $this->includefile("bookingcoverage");
        break;
    case "boder_ledige":
        $this->includefile("ledigeboder");
        break;
    default:
        $this->includefile("bookingreferences");
}
?>