<?
$refid = $_POST['data']['refid'];
$reference = $this->getApi()->getHotelBookingManager()->getReservationByReferenceId($refid);
echo "<div style='padding:20px;'>";
for($i = 0; $i < sizeof($reference->contact->names);$i++) {
?>
        <input type='hidden' value='<? echo $refid; ?>' id='referenceId'>
        <?
        /* @var $this \ns_15e67fa1_c862_4bc3_9b17_dfd818f30712\HotelbookingManagement */
        $rooms = $this->getApi()->getHotelBookingManager()->getAllRooms();
        echo "<div style='height: 50px;'>";
        echo "<select style='float:right;' name='moveRoomSelection[".$i."]' class='roomselection' oldroom='".$reference->rooms[$i]->roomId."'>";
        foreach($rooms as $room) {
            /* @var $room core_hotelbookingmanager_Room */
            $selected = "";
            if($room->id == $reference->rooms[$i]->roomId) {
                $selected = "SELECTED";
            }
            
            echo "<option value='".$room->id."' ".$selected.">" . $room->roomName . "</option>";
        }
            ?>
            </select>
            <b><? echo $this->__f("Select a new room for") . " " . $reference->contact->names[$i]; ?> </b><br>
            <bR>
<? } ?>
</div>
<div>
    <input type="text" class='startdate' style="float:right;" value='<? echo date("d-m-Y", strtotime($reference->startDate)); ?>'>
    Start date<br>
    <br>
</div>
<div>
    <input type="text" class='enddate' style="float:right;" value='<? echo date("d-m-Y", strtotime($reference->endDate)); ?>'>
    End date<br>
    <br>
</div>
    <div style="text-align:right;">
        <input type="button" id="doChangeRoom" value="<? echo $this->__f("Update room"); ?>">
    </div>
</div>