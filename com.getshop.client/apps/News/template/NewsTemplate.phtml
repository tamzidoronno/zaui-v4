<? namespace ns_dabb8a85_f593_43ec_bf0d_240467118a40; 
$imgApp = $this->getImageDisplayer();
?>
<script src='/js/packery.js'></script>
<?php
/* @var $this News */
if ($this->hasWriteAccess()) {
    ?>
<div class='addnewsrow'>
        <table width='100%'>
            <tr>
                <td width='20%' valign='top'>
                <?php
                    $this->getFactory()->getPage()->renderApplicationSimple($imgApp->configuration->id,$this);
                ?>
                <td>
                <td width='80%' valign='top'>
                    <div class="outeraddnewscontainer">
                        <? echo $this->__f("Subject"); ?><br> <input id="subject" name="subject" type="text" class='gsautosave' value='<? echo $this->getAutoSaved("subject"); ?>'/>
                        <br><br> <? echo $this->__f("Extended description"); ?> 
                        <br>
                        <textarea  name='content' class='gsautosave' 
                                   style="width: 100%; height: 100px; padding: 10px;box-sizing: border-box;" 
                                   placeholder="<? echo $this->__f("Click on me to edit"); ?>"><? echo $this->getAutoSaved("content"); ?></textarea>
                        <div class="gs_button addevent">
                            <? echo $this->__f("Add"); ?>
                        </div>
                    </div>
                <td>
            </tr>
        </table>
</div>
    <?php
} 

$entries = (array)$this->getAllEntries();
$i = 0;
?>
<div class='newscontainerbox_loading'>
    <i class='fa fa-spinner fa-spin'></i>
</div>
<div class='newscontainerbox'  data-packery-options='{ "columnWidth": ".grid-sizer", "itemSelector": ".news_container", "percentPosition": true, "gutter": 10 }'>
<?php
foreach($entries as $entry) {
    /* @var $entry app_newsmanager_data_NewsEntry */
    $last = (sizeof($entries)-1) == $i ? "last" : "";
    $id = $entry->id;
    echo "<div class='news_container item news_container_$i $last' id='".$id."'>";
    if($entry->image) {
        echo "<img src='displayImage.php?id=".$entry->image."'>";
    }
    if ($this->hasWriteAccess()) {
        echo "<div class='gs_button small delete'>".$this->__f("Delete")."</div>";
    }
    echo "<div class='news_entry_header'><h2>" . $entry->subject . "</h2></div>";
    echo "<div class='content'>";
    echo $entry->content;
    echo "</div>";
    echo "<div class='news_entry_footer'>" . $entry->date ."</div>";
    echo "</div>";

    $i++;
}
?>
</div>
    <script>
        $(function() {
            $(document).find('img').batchImageLoad({
                    loadingCompleteCallback: function() {
                        $('.newscontainerbox_loading').hide();
                        $('.newscontainerbox').show();
                        <?php if(!$this->getFactory()->isMobile()) { ?>
                            $('.newscontainerbox').packery({ gutter: 10 });
                        <?php } ?>
    }
            });
        });
    </script>
