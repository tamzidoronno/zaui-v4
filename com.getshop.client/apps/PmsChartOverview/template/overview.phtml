<?php
$boxes = array();
$boxes["Arrivals"] = "Number of guests arriving today and tomorrow";
$boxes["DEPARTURES"] = "Number of guests leaving the hotel today and tomorrow";
$boxes["NEW BOOKINGS"] = "New bookings registered today";
$boxes["CLEANING"] = "Number of room to clean";
$boxes["GUEST COMMENTS"] = "Number of comments from the guests";
$boxes["ECONOMY"] = "Total value of income generated today and tomorrow (ex taxes)";
$boxes["Coverage"] = "Total coverage for the specified day";
$boxes["Janitor"] = "Number of tasks in queue for the janitor";

$colors["Arrivals"] = "green";
$colors["DEPARTURES"] = "orange";
$colors["NEW_BOOKINGS"] = "pink";
$colors["CLEANING"] = "lightblue";
$colors["GUEST_COMMENTS"] = "pink";
$colors["ECONOMY"] = "lightgreen";
$colors["Coverage"] = "yellow";
$colors["Janitor"] = "green";
?>

<div class='dashboard_main'>
    <?php
    foreach($boxes as $title => $desc) {
        $field = str_replace(" ", "_", $title);
    ?>
    <div class="statistics_outer <?php echo $field; ?>">
        <div class="statistics <?php echo $field; ?>">
            <div class='header'>
                <?php echo $title; ?>
                <i class='fa fa-info-circle' title='<?php echo $desc; ?>'></i> 
            </div>
            <div class='inner'>
                <? $color = $colors[$field]; ?>
                <div class="statiticbox counter <? echo $color; ?> counter1">
                    <div class="filecount boldFont">
                        <i class='fa fa-spin fa-spinner'></i>
                    </div>
                    
                    <div class="box_explainer">
                    <?php
                        if($field == "Janitor") {
                            echo $this->__f("In queue");
                        } else {
                            echo $this->__f("Today");
                        }
                    ?>
                    </div>
                </div>
                
                <div class="statiticbox counter grey counter2">
                    <div class="filecount boldFont"><i class='fa fa-spin fa-spinner'></i></div>
                    
                    <div class="box_explainer">
                         <?php
                            if($field == "NEW_BOOKINGS") {
                                echo $this->__f("Yesterday");
                            } else if($field == "Janitor") {
                                echo $this->__f("Completed");
                            } else {
                                echo $this->__f("Tomorrow");
                            }
                        ?>
                    </div>
                </div>    
            </div>    
        </div>
    </div>
    <script>
        var event = thundashop.Ajax.createEvent('','lazyLoadOverviewData',$('.PmsChartOverview'), {
            "view" : "<?php echo $field; ?>"
        });
        
        thundashop.Ajax.postWithCallBack(event, function(res) {
            var json = JSON.parse(res);
            
            var timerCounter = 0;
            var countertoday = 1;
            var todayContainer = $('.PmsChartOverview .<?php echo $field;?>').find('.counter1 .boldFont');
            for(var i = 0; i <= json.today;) {
                setTimeout(function() {
                    if(json.today > 1000) {
                        countertoday += 199;
                    } else if(json.today > 10000) {
                        countertoday += 1999;
                    } else if(json.today > 100000) {
                        countertoday += 19999;
                    } else {
                        countertoday++
                    }
                    
                    if(countertoday > json.today) {
                        countertoday = json.today;
                    }
                    
                    todayContainer.html(countertoday);
                    
                }, (20*timerCounter));
                timerCounter++;
                if(json.today > 1000) {
                    i += 199;
                } else if(json.today > 10000) {
                    i += 1999;
                } else if(json.today > 100000) {
                    i += 19999;
                } else {
                    i++
                }
            }
            
            
            
            
            
            var timerCounter = 0;
            var counterTomorrow = 1;
            var tomorrowContainer = $('.PmsChartOverview .<?php echo $field;?>').find('.counter2 .boldFont');
            for(var i = 0; i <= json.tomorrow;) {
                setTimeout(function() {
                    if(json.tomorrow > 1000) {
                        counterTomorrow += 199;
                    } else if(json.tomorrow > 10000) {
                        counterTomorrow += 1999;
                    } else if(json.tomorrow > 100000) {
                        counterTomorrow += 19999;
                    } else {
                        counterTomorrow++
                    }
                    
                    if(counterTomorrow > json.tomorrow) {
                        counterTomorrow = json.tomorrow;
                    }
                    
                    tomorrowContainer.html(counterTomorrow);
                    
                    
                }, (20*timerCounter));
                timerCounter++;
                if(json.tomorrow > 1000) {
                    i += 199;
                } else if(json.tomorrow > 10000) {
                    i += 1999;
                } else if(json.tomorrow > 100000) {
                    i += 19999;
                } else {
                    i++
                }
            }
        });
    </script>
<?php } ?>
</div>
