<?php
/* @var $this ns_7e828cd0_8b44_4125_ae4f_f61983b01e0a\PmsManagement */
$filter = $this->getOrderStatsFilter();
$priceType = $_POST['data']['priceType'];

$states = \ns_27716a58_0749_4601_a1bc_051a43a16d14\OrderManager::getOrderStatuses();
$states["0"] = "All states";
$states[-9] = "Credit notes";
$states[-10] = "Everything transferred to accounting";

$paymentMethods = $this->getApi()->getStoreApplicationPool()->getActivatedPaymentApplications();
$pmethodToPrint = array();
$pmethodToPrint[""] = "All payment methods";
foreach ($paymentMethods as $key => $method) {
    $pmethodToPrint[$method->id] = $method->appName;
}
if(isset($filter->methods)) {
    echo "<table cellspacing='0' cellpadding='0'>";
    echo "<tr>";
    echo "<th></th>";
    echo "<th></th>";
    echo "<th></th>";
    echo "</tr>"; 
    foreach($filter->methods as $method) {
        echo "<tr>";
        echo "<td><i class='fa fa-trash-o removePaymentMethod' style='cursor:pointer;' toremove='".$method['paymentMethod']."-".$method['paymentStatus']."'></i></td><td>" . $pmethodToPrint[$method['paymentMethod']] . " </td><td> " . $states[$method['paymentStatus']] . "</td>";
        echo "</tr>";
    }
    echo "</table>";
}

$resultMatrix = $this->buildResultMatrix(true);

echo "<table cellspacing='0' cellpadding='0'>";

foreach($resultMatrix as $index => $row) {
    $extra = "";
    if($index != "header" || $index == "0") {
        $extra = "class='loadStatsForDay' style='cursor:pointer;' index='$index'";
    }
    echo "<tr $extra>";
    foreach($row as $cell) {
        if($index == "header" && $index != "0") {
            echo "<th>$cell</th>";
        } else {
            echo "<td>$cell</td>";
        }
    }
    echo "</tr>";
}

echo "</table>";
?>    
</pre>
