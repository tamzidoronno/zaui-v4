<?php
/* @var $this \ns_1ba01a11_1b79_4d80_8fdd_c7c2e286f94c\PmsSearchBox */
$servers = (array)$this->getApi()->getGetShopLockSystemManager()->getLockServers();

foreach($servers as $server) {
    $down = false;
    if(!$server->lastPing) {
        $down = true;
    }
    $diff = time() - strtotime($server->lastPing);
    if($diff > 300) {
        $down = true;
    }
    if($down) {
        echo "<div style='font-size:14px; color:red; font-weight:bold; text-align:left'>";
        echo "WARNING: Server with servername: " . $server->givenName . " is not responding, last contact: ". date("d.m.Y H:i", strtotime($server->lastPing)) . " - <a target='resolveserver' href='/scripts/resolveserver/index.php?id=".$server->id."&step=2&unit=zwaveserver'>click here to resolve the issue</a>";
        echo "</div>";
    }
}
?>