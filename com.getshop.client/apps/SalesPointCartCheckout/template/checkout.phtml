<?
/* @var $this \ns_90d14853_2dd5_4f89_96c1_1fa15a39babd\SalesPointCartCheckout */
$originalCart = $this->getOriginalCartFromSession();
$currentCart = $this->getCurrentCart();
$total = $this->getApi()->getCartManager()->getCartTotal($currentCart);

$items = (array)$originalCart->items;
$i = 0;

if (!count($items)) {
    echo "Nothing to do";
    return;
}

foreach ($items as $item) {
    $i++;
    $lastItem = count($items) == $i ? "last_row" : "";
    $this->setCurrentItem($item);
    
    echo '<div class="cartitem row '.$lastItem.'" cartItemId="'.$item->cartItemId.'">';
    
    if ($item->addedByGetShopModule == "pms") {
        if (isset($item->priceMatrix) && $item->priceMatrix && count($item->priceMatrix)) {
            $this->includefile("pmswithmatrixitem");
        } else if(isset($item->itemsAdded) && $item->itemsAdded && count($item->itemsAdded)) {
            $this->includefile("pmsaddons");
        } else {
            $this->includefile("pmsnormalcartitem");
        }
    } 
    
    echo "</div>";
}
?>

<div class='summary'>
    <? echo $this->__f("Total"); ?>: <span><? echo $total; ?></span>
</div>

<?

if ($this->isReadOnly()) {
    return;
}


$paymentApps = $this->getApi()->getStoreApplicationPool()->getActivatedPaymentApplications();
?>

<div class="payment_options payment_window">

    <div class="option_content">
       
    </div>
    
    <div class="options">
        
        <?
        foreach ($paymentApps as $app) {
            ?>
            <div class="shop_button" gsclick="createOrder" style="font-size: 14px;" payment="<? echo $app->id; ?>">
                <? echo $app->appName; ?>
            </div>        
        <?
        }
        ?>
    </div>
    
</div>
