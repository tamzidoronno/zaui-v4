<?php
namespace ns_1051b4cf_6e9f_475d_aa12_fc83a89d2fd4;

/* * Â @var $menu TopMenu */
$menu = $this;
$entries = $menu->getEntries();
$pageId = $menu->getPage()->id;
$renaming = false;
$currentUser = \ns_df435931_9364_4b6a_b4b2_951c90cc0d70\Login::getUserObject();
if(isset($_POST['event']) && $_POST['event'] == "renameEntry") {
    $renaming = true;
}

?>

<ul class="breadcrumb-menu" id="topmenuline">
    <li class="mobile" style="display: none;"><? echo $this->__w("Menu"); ?></li>
    <span class="droparea droparea_first"></span>
    <?php
    
    function printEntries($entries, $pageId, $menu, $container, $isTop, $currentUser) {
        if(isset($entries)) {
            $counter = 0;
            foreach ($entries as $entry) {
                
                if ($entry->userLevel != null && $entry->userLevel > 0 && ($currentUser == null || $entry->userLevel > $currentUser->type)) {
                    continue;
                }
                
                $counter++;
                $first = !isset($first) ? "first" : "";
                $last = (count($entries) == $counter) ? "last" : "";

                if (!$entry->pageId) {
                    $entry->pageId = "home";
                }

                $selected = "";
                $selected_entry = "";
                if ($pageId == $entry->pageId) {
                    $selected = "selected";
                    $selected_entry  = "selected_entry";
                }

                $menu->setCurrentMenuEntry($entry);
                /* @var $entry core_listmanager_data_Entry */
                ?><li class="configable entry <? echo $first; echo $last; echo " ".$selected_entry; ?>" interrupt="false" menuid="<? echo  $entry->id; ?>">
                    <?php
                    if (\ns_df435931_9364_4b6a_b4b2_951c90cc0d70\Login::isAdministrator() && $isTop) {
                        $container->includeFile("LeftMenuTemplateMenuConfiguration", "LeftMenu");
                        echo "<span class='edit'></span>";
                    }
                    if (@$_POST['event'] == "renameEntry" && @$_POST['data']['id'] == $entry->id) {
                        ?>
                        <span gstype="form" method="renameEntry">
                            <input gstype="submitenter" method="renameEntry" class='renametopmenuinput'  gsname="newentry" type="text" placeholder="<?php echo $entry->name; ?>">
                            <input type="hidden" gsname="renameId" value="<?php echo $entry->id; ?>">
                        </span>

                        <?php
                    } else {
                        ?>
                        <span>
                            <?php
                            /* @var $entry \core_listmanager_data_Entry */
                            $hardlink = "false";
                            if($entry->hardLink) {
                                $hardlink="true";
                                $url = $entry->hardLink;
                            } else {
                                $link = "?page=".$entry->pageId;
                                $url = \GetShopHelper::makeSeoUrl($entry->name);
                            }
                            $icon = "";
                            if($entry->fontAwsomeIcon) {
                                $icon = "<i class='fa " . $entry->fontAwsomeIcon."'></i>";
                            }
                            if($entry->subentries) {
                                ?>
                                <a ajaxlink="<?php echo $link; ?>" href="<? echo $url; ?>" class="<?php echo $selected; ?>" hardlink="<?php echo $hardlink; ?>"><?php echo $icon.$entry->name; ?></a>
                                <?
                                echo '<ul class="subentries" id="topmenuline">';
                                    printEntries($entry->subentries, $pageId, $menu, $container, false, $currentUser);
                                echo '</ul>';
                            } else {
                            ?>
                            <a ajaxlink="<?php echo $link; ?>" href="<? echo $url; ?>" class="<?php echo $selected; ?>" hardlink="<?php echo $hardlink; ?>"><?php echo $icon.$entry->name; ?></a>
                            <? } ?>
                        </span>
                        <?php
                    }
                    ?>
                <span class='droparea'></span>
                </li>
                <?
            }
        }
    }
    
    printEntries($entries, $pageId, $menu, $this, true, $currentUser);
    if (\ns_df435931_9364_4b6a_b4b2_951c90cc0d70\Login::isAdministrator()) {
        ?>
        <li class="addnew">
            <span id="add_new_top">
                <i class="fa fa-plus-square" title="<? echo $this->__f("Add new menu entry"); ?>"></i>
            </span>
        </li>
        <li>
            <input id="add_top_menu_entry" method="addEntry" gstype="clicksubmit" gsname="newentry" type="txt" placeholder="<?php echo $this->__f("Enter a menu name"); ?>">
        </li>
    <?php } ?>
</ul>
<?
if($this->isEditorMode() && !$renaming) {
?>
    <script>
    thundashop.app.TopMenu.activateOrdering();
    </script>
<? } ?>
